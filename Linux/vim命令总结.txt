vim 命令详解

一、 简介

vi/view: Visual Interface 可视化接口
vim: VI iMproved 是vi的增强版

二、 模式

vim 模式：
编辑模式（命令模式、正常模式）：此模式屏幕下方一般无显示或显示文件名
输入模式（插入模式）：此模式下屏幕下方会显示 -- INSERT --
末行模式（冒号模式）：此模式下屏幕最下方是显示 ：

模式转换（切换）， --> 表示由箭头前面模式转换为后面的模式

编辑模式 --> 输入模式

	i: 在当前光标所在字符的前面，转为输入模式
	I：在当前光标所在行的行首，转换为输入模式

    a: 在当前光标所在字符的后面，转为输入模式
    A：在当前光标所在行的行尾，转换为输入模式
	
    o: 在当前光标所在行的下方，新建一行，并转为输入模式
    O：在当前光标所在行的上方，新建一行，并转为输入模式

输入模式或末行模式 --> 编辑模式
	ESC

编辑模式 --> 末行模式
	：
	
输入模式和末行模式不能直接转换。

三、基本使用
1. 打开文件

vim +N  filename 
N为数字表示行号，打开文件并定位到第N行

vim +   filename
不加数字会打开文件定位到文件末行

vim +/PATTERN
打开文件定位到第一次被PATTERN匹配到的行的行首，退出后再次使用此命令打开会定位到第二次匹配的行的行首。

2. 关闭文件

1) 末行模式关闭文件

	:q 退出，无修改才可以这样退出

	:wq 保存并退出
	
	:q! 不保存退出，即修改过文件，不想保存就这样退出
	
	:w 保存，修改了一部分，想先保存一下，继续保持编辑模式
	
	:w! 强制保存 有些文件没有可写的属性，但是root用户可以用此命令强制写入
	
	:x 保存并退出 与 :wq 的区别是如果文件没有修改，不会更改文件修改时间，:wq 是即使文件没有修改也更改文件的修改时间。
	
2) 编辑模式下退出
	ZZ

3. 移动光标

1) 逐字符移动

h  向左移动
l  向右移动
j  向下移动
k  向上移动

也可以用方向键。

Nh Nl Nj Nk   N为数字表示移动多个字符

2) 以单词为单位移动

    w 移至下一个单词的词首

    e 跳至当前或下一个单词的词尾

    b 跳至当前或前一个单词的词首
	
同样前面可加数字，表示移动多个。

3) 行内跳转
    0 绝对行首，也可以用Home键

    ^ 行首的第一个非空白字符

    $ 绝对行尾，也可以用End键

4) 行间跳转

    NG N为数字，表示跳转至第N行

    gg 第一行

    G  最后一行
	
5) 末行模式跳转
	.  表示当前行
	$  表示最后一行，跳到最后一行
	N  表示第N行，跳到第N行
	+N 表示从当前行向下跳转N行

4. 翻屏

    Ctrl+f: 向下翻一屏
	
    Ctrl+b: 向上翻一屏

    Ctrl+d: 向下翻半屏

    Ctrl+u: 向上翻半屏
	
5. 删除字符
    x: 删除光标所在处的单个字符

    Nx: 删除光标所在处及向后的共N个字符

6. 删除命令
	d可以跟跳转命令组合使用（不常用）
	dw  删除从当前字符到下一个单词词首的部分
	de  删除从当前字符到当前或下一个单词词尾的部分
	db  删除从当前字符到当前词首或下一个单词词首的部分
	
	dd 删除当前光标所在行
	Ndd 删除N行
	
7. 粘贴
    p: 如果删除或复制为整行内容，则粘贴至光标所在行的下方，如果复制或删除的内容为非整行，则粘贴至光标所在字符的后面

    P: 如果删除或复制为整行内容，则粘贴至光标所在行的上方，如果复制或删除的内容为非整行，则粘贴至光标所在字符的前面

8. 复制
	y
	用法同d
	
9. 先删除内容，再转换为输入模式
	c用法同d

10. 替换

    r：单字符替换

    Nr: 光标后N个字符全部替换

    R: 替换模式

11. 撤销

    u：撤消前一次的编辑操作

    Nu: 直接撤消最近N次编辑操作

    连续u命令可撤消此前的n次编辑操作

    撤消最近一次撤消操作：Ctrl+r
	
12. 重复前一次编辑操作
	. 编辑模式重复前一次编辑操作

13. 可视化模式
	
	v: 按字符选取

    V：按行选取
	
	Ctrl+v 是按块选取
    常用的是删除一段配置的注释或是注释掉一段配置

14. 查找

	/   从开头开始查找
	?   从结尾开始查找
	n  下一个查找到的
	N  上一个查找到的

15. 查找并替换
	headline,footlines/PATTERN/string/
	headline,footlines/PATTERN/string/g
	headline,footlines/PATTERN/string/gc

    1,$:表示从首行到末行即全文同%

    %：表示全文
	
	g 表示全局替换，不加g的话只替换每行第一次查找到的
	
	c 表示替换前给出提示，需要再一次确认是否替换

16. 编辑多个文件

    vim FILE1 FILE2 FILE3

    :next 切换至下一个文件

    :prev 切换至前一个文件

    :last 切换至最后一个文件

    :first 切换至第一个文件
	
	在vim窗口中打开一个新文件
	:open file

	在新窗口中打开文件
	:split file
	
	切换到下一个文件
	:bn

	切换到上一个文件
	:bp

17. 分屏显示

1)一个文件

    Ctrl+w, s: 水平拆分窗口

    Ctrl+w, v: 垂直拆分窗口
	
    在窗口间切换光标：
    Ctrl+w, (h,j,k,l或方向键) 
	
2)多个文件

    vim -o : 水平分割显示

    vim -O : 垂直分割显示
	
18. 将当前文件中的部分另存为一个文件

	末行模式下使用w命令

    :ADDR1,ADDR2w /path/to/somewhere

19. 将另外一个文件的内容填充到当前文件

    :r /path/to/somefile
	默认不加行号是添加到当前光标所在行的行后
	:5r /path/to/somefile
	添加到第5行后面

20. 执行系统命令(不常用)

	末行模式下加!command       
	command为系统命令
	
	:!command

四、高级用法

末行模式下

1. 显示行号和取消显示
	
	:set nu
	:set nonu
	nu = number
	
2. 显示忽略或区分字符大小写

    :set ic

    :set noic

    ic = ignorecase
	
3. 设定自动缩进

    :set ai

    :set noai

    ai = autoindent
	
4. 查找到的文本高亮显示或取消

    :set hlsearch

    :set nohlsearch
	
5. 语法高亮

    :syntax on

    :syntax off

6. 写入配置文件

    /etc/vimrc    针对所有用户

    ~/.vimrc    针对当前用户
